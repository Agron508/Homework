---
title: "Assignment1"
author: "Kelsie Ferin and Theo"
date: "January 29, 2018"
output:
  pdf_document: default
  html_document: default
---


## Assignment 1 

### Part 1: Example problem from the physics text book (pg. 105)

Below are the constants that will be used throuout the first part of the code.
```{r}
# Planck's constant [Js]
h=6.62606896e-34
# speed of light [m/s]
c=2.99792458e8 
# Boltzman constant [J/K]
k=1.3806504e-23 

# temperature used for sun in example [K]
T = 5800
```

To calculate the following equations of a blackbody with a different waveband, change sequence range for lambda!
```{r}
# the following lambda will not be used, this is for the entire spectrum of visible light
#lambda = seq(3.4e-7,8.05e-7, by=1e-10)

# this lambda sequence is for the band of wavelengths used in the example problem [m]
lambda = seq(6.0e-7,6.05e-7, by=1e-10)
```

The following 3 equations are for each 3 steps in the example problem. 

Equation 1: The exponential portion of Planck's equation. This is unitless.
```{r}
# Equation 1
y = (h*c)/(lambda*k*T)
plot(lambda,y,xlab='Wavelength (m)',ylab='Plancks Exponential',main='Part #1: Equation 1')
```

Equation #2: Spectral Emittance of the sun (I; W/m^2/m)
```{r}
I=((2*pi)*(h)*(c**2)/((lambda**5)*(exp(y)-1)))
plot(lambda,I,xlab='Wavelength (m)',ylab='Spectral Emittance (W/m^2/m)',main='Part #1: Equation 2')
```

Equation #3: This plot is the intesnity (MW/m^2) for the given spectral emittance (W/m^2/m) values calculated in equation 2.
```{r}
Ilambda = (I*(max(lambda)-min(lambda)))*1e-6
plot(I,Ilambda,xlab='Spectral Emittance (W/m^2/m)',ylab='Intensity (MW/m^2)',main='Part #1: Equation 3')
```

### Part 2: Power within a waveband
Here we will compare the total amount of power of the blackbody calculation to the data collected from the spectral radiometer in class. 
Just as a reminder, spectral emittance is what Plancks's Law gives for the sun with this temperature. Spectral irradience is what is measured here on Earth. These values will NOT be the same due to Earth's atmosphere and its absorbtion in some wavelengths

The equations in part 1 use [m] for the wavelengths. We need to convert these to nm to stay consistent with the collected data. 
```{r}
lambda_nm=lambda*1e+9
I_new = I/1e+9
plot(lambda_nm,I_new,xlab='Wavelength (nm)',ylab='Spectral Emittance (W/m^2/nm)',main='Part #2: Equation 1')
```

Now we need to use the values collected during class. The following chunk of code is from Anabelle:

```{r, include=FALSE}
# Open the librarys that are needed to do the following steps. 
#knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(ggplot2)
# Read in the data
tab<-read_csv("https://raw.githubusercontent.com/Agron508/Homework/master/SS-110_1010_12918noon.csv")
```

```{r}
# Some cleaning
data<-tab[2:482,] # select rows
data<-data %>% rename(waveL=Timestamp) # rename column 
data$waveL<-as.numeric(as.vector(data$waveL)) # to get a x_continous scale, data need to be numeric not factor

#Plot the Spectral Irradiance as a function of wavelength (nm)
time<-data[,82]# here I just pick a column randomly
#class(time)
# time has to be converted into numeric 
time<-as.numeric(unlist(time)) # I used unlist to convert all the element to a single numeric vector
ggplot(data=data,aes(x=waveL,y=time))+
  geom_line() +
  scale_x_continuous(breaks = round(seq(min(data$waveL), max(data$waveL), by = 100),1)) +
  scale_y_continuous(breaks = round(seq(min(time), max(time), by = 0.005),1)) +
  xlab("wavelength (nm)") +
  ylab("Spectral Irradiance (W/m2/micrometer)")
```


First we need to convert the spectral irradiance from W/m2/micrometer to W/m2/nm:
```{r}
irradiance = time*1e+3
wavelength = data$waveL
plot(wavelength,irradiance,type="o",xlab='Wavelength (nm)',ylab='Spectral Irradiance (W/m^2/nm)',main='Part #2: Collected Data')
```

We only want to use the wavelength band  of 600-605nm to compare to the black body, which is shown in the following plot. 
```{r}
irradiance_data = irradiance[261:266]
band_data = data$waveL[261:266]
plot(band_data,irradiance_data,type="o",xlab='Wavelength (nm)',ylab='Spectral Irradiance (W/m^2/nm)',main='Part #2: Collected Data')
```

Lastly, we need to integrate the area under the curve for both the blackbody and observed values:
```{r}
# Blackbody Integration (emittance)
bb_E_integ = sum(I_new * 0.1)
cat("Blackbody value of total power: ", bb_E_integ, "W/m^2")
```
```{r}
# Observed Integration (irradiance)
obs_I_integ = sum(irradiance_data)
cat("Observed alue of total power: ", obs_I_integ, "W/m^2")

```

### Part 3: Example problem; Photons required for sight!

First, we define the constants that will be used in these calculations:
```{r}
#Intensity of radiation reaching the eye in order for the human eye to percieve light.
I = 4.0e-11 # Units - W/m^2

#Plancks Constant 
h = 6.63e-34 # Units - J*s

#Speed of light in a vacuum
c = 3.0e8 # Units - m/s
```
Secondly, we calculate the area of the pupil:
(According to NCBI the diameter of a human pupil ranges from 2 mm to 8mm)

```{r}

#Diameter of a human pupil
d = seq(2,8,by = 1) # Units - mm

#Convert the diameter to meters
d = d*1e-3 # Units - m 

#Calculate the pupil area
pupil_area = pi*((d/2)^2) # Units - m^2


```

Third, we calculate the power reaching the eye:

```{r}

#Power reaching the eye
Power_reach_eye = I*pupil_area # Units - W
```
Fourth, we calculate the energy of a photon for wavelengths in the visible spectrum:

```{r}

#Range of wavelength in the visible spectrum
lam_pupil = seq(380e-9,780e-9,by = 1e-9) #Units - m

#Energy of a photon
e = (h*c)/lam_pupil

```
Fifth, we calculate the amount of photons reaching the eye
```{r}

#Create Vector for Calculations
Photons_reach_eye = matrix(0,401,7)

#Number of photons reaching the eye
for(i in 1:401){
  for(j in 1:7){
    Photons_reach_eye[i,j] = Power_reach_eye[j]/e[i] #Units - photons/s
  }
}
  

```
Sixth, we plot the results of this experiment:

```{r}
library(ggplot2)
#Set data up in a frame to plot
data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])

#Plotting 
col_set = rainbow(ncol(Photons_reach_eye))
matplot(lam_pupil,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Wavelength (m)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Pupil Size = 2mm","Pupil Size = 3mm","Pupil Size = 4mm","Pupil Size = 5mm","Pupil Size = 6mm","Pupil Size = 7mm","Pupil Size = 8mm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[401,7],leg.txt,cex = .5,lwd = 2, col = col_set)
```

##Now Lets Use The Spectrum Which We Measured To See How Many Photons Our Eyes Were Intercepting

```{r}
#Because we can calculate the number of photons by taking the Intensity of the Radiation divided by the energy of a photon at that wavelength, we can take the intensity measured divided by the power at that wavelength and come up with a total number of photons!



```







