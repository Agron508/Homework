for(i in 1:401){
for(j in 1:7){
Photons_reach_eye[i,j] = Power_reach_eye[j]/e[i] #Units - photons/s
}
}
#Set data up in a frame to plot
data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(lam_pupil,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Wavelength (m)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Pupil Size = 2mm","Pupil Size = 3mm","Pupil Size = 4mm","Pupil Size = 5mm","Pupil Size = 6mm","Pupil Size = 7mm","Pupil Size = 8mm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[401,7],leg.txt,cex = .5,lwd = 2, col = col_set)
#Lets convert these numbers into PPFD to be able to compare them to what we know
PPFD_eye = Photons_reach_eye /(6.02e23) * 1e6 / pupil_area
#Now let's plot the results of this, like we plotted the others
#Set data up in a frame to plot
data_pup = data.frame(x = lam_pupil,y1 = PPFD_eye[,1], y2 = PPFD_eye[,2], y3 = PPFD_eye[,3], y4 = PPFD_eye[,4], y5 = PPFD_eye[,5], y6 = PPFD_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(lam_pupil,PPFD_eye,type = "l",main = "Photons Flux Density at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Wavelength (m)",ylab = "Photon Flux Density",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Pupil Size = 2mm","Pupil Size = 3mm","Pupil Size = 4mm","Pupil Size = 5mm","Pupil Size = 6mm","Pupil Size = 7mm","Pupil Size = 8mm")
cex = .5
legend(lam_pupil[1],PPFD_eye[401,7],leg.txt,cex = .5,lwd = 2, col = col_set)
#Because we can calculate the number of photons by taking the Intensity of the Radiation in our pupil divided by the energy of a photon at that wavelength, we can take the intensity measured divided by the power at that wavelength and come up with a total number of photons!
#Lets assume a pupil size of 6mm
#Calculating the Intensity of radiation hitting your eye
Intensity_pupil = time * pupil_area[5] #Units - W
#Calculating the photon energy of the wavelengths that we measured
e_meas = (h*c)/(wavelength*1e-9) #Units - J
#Now to calculate the number of photons that are making it to our eyes
Photons_reach_eye_measured = Intensity_pupil/e_meas#Units - Photons/s
#If we sum up all of the photons from every wavelength, we see about how many photons per second are hitting our eyes
Total_Photons = sum(Photons_reach_eye_measured)#Units - Photons/s
cat("Total Photons Reaching Our Eyes With Our Measured Data:", Total_Photons," Photons/s")
View(lam_pupil)
#Intensity of radiation reaching the eye in order for the human eye to percieve light.
I_eye = 4.0e-11 # Units - W/m^2
#The following are called in the beginning of the assingment:
#Plancks Constant: h = 6.63e-34 # Units - J*s
#Speed of light in a vacuum: c = 3.0e8 # Units - m/s
#Diameter of a human pupil
d = seq(2,8,by = 1) # Units - mm
#Convert the diameter to meters
d = d*1e-3 # Units - m
#Calculate the pupil area
pupil_area = pi*((d/2)^2) # Units - m^2
#Power reaching the eye
Power_reach_eye = I_eye*pupil_area # Units - W
#Range of wavelength in the visible spectrum
#lam_pupil = seq(380e-9,780e-9,by = 1e-9) #Units - m
lam_pupil = array(c(455e-9,492e-9,577e-9,597e-9,622e-9,780e-9))
#Energy of a photon
e = (h*c)/lam_pupil #Units - J
#Create Vector for Calculations
Photons_reach_eye = matrix(0,6,7)
#Number of photons reaching the eye
for(i in 1:6){
for(j in 1:7){
Photons_reach_eye[i,j] = Power_reach_eye[j]/e[i] #Units - photons/s
}
}
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Wavelength (m)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
#Create Vector for Calculations
Photons_reach_eye = matrix(0,6,7)
#Number of photons reaching the eye
for(i in 1:6){
for(j in 1:7){
Photons_reach_eye[i,j] = Power_reach_eye[j]/e[i] #Units - photons/s
}
}
rm(data_pup)
rm(data)
#Create Vector for Calculations
Photons_reach_eye = matrix(0,6,7)
#Number of photons reaching the eye
for(i in 1:6){
for(j in 1:7){
Photons_reach_eye[i,j] = Power_reach_eye[j]/e[i] #Units - photons/s
}
}
#Create Vector for Calculations
Photons_reach_eye = matrix(0,6,7)
#Number of photons reaching the eye
for(i in 1:6){
for(j in 1:7){
Photons_reach_eye[i,j] = Power_reach_eye[j]/e[i] #Units - photons/s
}
}
Photons_reach_eye = t(Photons_reach_eye)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Wavelength (m)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Pupil Size = 2mm","Pupil Size = 3mm","Pupil Size = 4mm","Pupil Size = 5mm","Pupil Size = 6mm","Pupil Size = 7mm","Pupil Size = 8mm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[6,7],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Pupil Size = 2mm","Pupil Size = 3mm","Pupil Size = 4mm","Pupil Size = 5mm","Pupil Size = 6mm","Pupil Size = 7mm","Pupil Size = 8mm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[6,7],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[1,6],leg.txt,cex = .5,lwd = 2, col = col_set)
# Planck's constant [Js]
h=6.62606896e-34
# speed of light [m/s]
c=2.99792458e8
# Boltzman constant [J/K]
k=1.3806504e-23
# temperature used for sun in example [K]
T = 5800
# the following lambda will not be used, this is for the entire spectrum of visible light
#lambda = seq(3.4e-7,8.05e-7, by=1e-10)
# this lambda sequence is for the band of wavelengths used in the example problem [currently in meters]
lambda = seq(6.0e-7,6.05e-7, by=1e-10)
# Equation 1
y = (h*c)/(lambda*k*T)
plot(lambda,y,xlab='Wavelength (m)',ylab='Plancks Exponential',main='Exponential from Plancks Equation')
I=((2*pi)*(h)*(c**2)/((lambda**5)*(exp(y)-1)))
plot(lambda,I,xlab='Wavelength (m)',ylab='Spectral Emittance (W/m^2/m)',main='Spectral Emittance over specified wavelenghts')
Ilambda = (I*(max(lambda)-min(lambda)))*1e-6
plot(I,Ilambda,xlab='Spectral Emittance (W/m^2/m)',ylab='Intensity (MW/m^2)',main='Intensity for range of spectral emittance')
abline(h=median(Ilambda))
plot(lambda,Ilambda,xlab='Wavelenght (m)',ylab='Intensity (MW/m^2)',main='Intensity for range of wavelengths')
abline(h=median(Ilambda))
lambda_nm=lambda*1e+9
I_new = I/1e+9
plot(lambda_nm,I_new,xlab='Wavelength (nm)',ylab='Spectral Emittance (W/m^2/nm)',main='Spectral emittance over range of wavelenths (in nm)')
# Open the librarys that are needed to do the following steps.
#knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(ggplot2)
# Read in the data
tab<-read_csv("https://raw.githubusercontent.com/Agron508/Homework/master/SS-110_1010_12918noon.csv")
# Some cleaning
data<-tab[2:482,] # select rows
data<-data %>% rename(waveL=Timestamp) # rename column
data$waveL<-as.numeric(as.vector(data$waveL)) # to get a x_continous scale, data need to be numeric not factor
#Plot the Spectral Irradiance as a function of wavelength (nm)
time<-data[,82]# here I just pick a column randomly
#class(time)
# time has to be converted into numeric
time<-as.numeric(unlist(time)) # I used unlist to convert all the element to a single numeric vector
ggplot(data=data,aes(x=waveL,y=time))+
geom_line() +
scale_x_continuous(breaks = round(seq(min(data$waveL), max(data$waveL), by = 100),1)) +
scale_y_continuous(breaks = round(seq(min(time), max(time), by = 0.005),1)) +
ggtitle("Spectral irradiance from class") +
xlab("wavelength (nm)") +
ylab(expression(paste("Spectral Irradiance (W/m2/",mu,"m)")))
irradiance = time/1e+3
wavelength = data$waveL
plot(wavelength,irradiance,type="o",xlab='Wavelength (nm)',ylab='Spectral Irradiance (W/m^2/nm)',main='Spectral irradiance of data collected in class')
sum(irradiance)*diff(wavelength)[1]
irradiance_data = irradiance[261:266]
band_data = data$waveL[261:266]
plot(band_data,irradiance_data,type="o",xlab='Wavelength (nm)',ylab='Spectral Irradiance (W/m^2/nm)',main='Spectral Irradiance from Collected Data')
plot(lambda_nm,I_new,type="o",xlab='Wavelength (nm)',ylab='Spectral Emittance (W/m^2/nm)',main='Spectral Emittance from Textbook')
# Blackbody Integration (emittance)
bb_E_integ = sum(I_new)*diff(lambda_nm)[1]
cat("Blackbody value of total power: ", bb_E_integ, "W/m^2")
# Observed Integration (irradiance)
obs_I_integ = sum(irradiance_data)*diff(band_data)[1]
cat("Observed value of total power: ", obs_I_integ, "W/m^2")
T2 = 6000
lambda2 = seq(3.4e-7,8.05e-7, by=1e-10)
y2 = (h*c)/(lambda2*k*T2)
I2=((2*pi)*(h)*(c**2)/((lambda2**5)*(exp(y2)-1)))
plot(lambda2,I2,xlab='Wavelength (m)',ylab='Spectral Emittance (W/m^2/m)',main='Spectral emmittance for visible range')
tot = sum(I2)*diff(lambda2)[1]
cat("Observed value of total power: ", tot, "W/m^2")
#Intensity of radiation reaching the eye in order for the human eye to percieve light.
I_eye = 4.0e-11 # Units - W/m^2
#The following are called in the beginning of the assingment:
#Plancks Constant: h = 6.63e-34 # Units - J*s
#Speed of light in a vacuum: c = 3.0e8 # Units - m/s
#Diameter of a human pupil
d = seq(2,8,by = 1) # Units - mm
#Convert the diameter to meters
d = d*1e-3 # Units - m
#Calculate the pupil area
pupil_area = pi*((d/2)^2) # Units - m^2
#Power reaching the eye
Power_reach_eye = I_eye*pupil_area # Units - W
#Range of wavelength in the visible spectrum
#lam_pupil = seq(380e-9,780e-9,by = 1e-9) #Units - m
lam_pupil = array(c(455e-9,492e-9,577e-9,597e-9,622e-9,780e-9))
#Energy of a photon
e = (h*c)/lam_pupil #Units - J
#Create Vector for Calculations
Photons_reach_eye = matrix(0,6,7)
#Number of photons reaching the eye
for(i in 1:6){
for(j in 1:7){
Photons_reach_eye[i,j] = Power_reach_eye[j]/e[i] #Units - photons/s
}
}
Photons_reach_eye = t(Photons_reach_eye)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Lets convert these numbers into PPFD to be able to compare them to what we know
PPFD_eye = Photons_reach_eye /(6.02e23) * 1e6 / pupil_area
#Now let's plot the results of this, like we plotted the others
#Set data up in a frame to plot
data_pup = data.frame(x = lam_pupil,y1 = PPFD_eye[,1], y2 = PPFD_eye[,2], y3 = PPFD_eye[,3], y4 = PPFD_eye[,4], y5 = PPFD_eye[,5], y6 = PPFD_eye[,6], y7 = Photons_reach_eye[,7])
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[7,5],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[6,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[5,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[5,5],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(lam_pupil[1],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(lam_pupil[2],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(lam_pupil[3],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm","/lambda = 455 nm")
cex = .5
legend(pupil_area[1],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("/lambda = 455 nm","\lambda = 455 nm","\lambda = 455 nm","\lambda = 455 nm","\lambda = 455 nm","\lambda = 455 nm","\lambda = 455 nm")
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("$/lambda = 455 nm"$,"\lambda = 455 nm","\lambda = 455 nm","\lambda = 455 nm","\lambda = 455 nm","$\lambda = 455 nm$","\lambda = 455 nm")
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c($/lambda = 455 nm$,"\lambda = 455 nm","\lambda = 455 nm","\lambda = 455 nm","\lambda = 455 nm","lambda = 455 nm$","\lambda = 455 nm")
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = rainbow(ncol(Photons_reach_eye))
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Wavelength = 455 nm","Wavelength = 492 nm","Wavelength = 577 nm","Wavelength = 597 nm","Wavelength = 622 nm","Wavelength = 780 nm")
cex = .5
legend(pupil_area[1],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
View(Photons_reach_eye)
View(Photons_reach_eye)
View(lam_pupil)
View(e)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = c("Violet","Blue","Green","Yellow","Orange","Red")
palette(col_set)
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = Photons_reach_eye)
leg.txt <- c("Wavelength = 455 nm","Wavelength = 492 nm","Wavelength = 577 nm","Wavelength = 597 nm","Wavelength = 622 nm","Wavelength = 780 nm")
cex = .5
legend(pupil_area[1],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = c("Violet","Blue","Green","Yellow","Orange","Red")
palette(col_set)
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Wavelength = 455 nm","Wavelength = 492 nm","Wavelength = 577 nm","Wavelength = 597 nm","Wavelength = 622 nm","Wavelength = 780 nm")
cex = .5
legend(pupil_area[1],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Lets convert these numbers into PPFD to be able to compare them to what we know
PPFD_eye = Photons_reach_eye /(6.02e23) * 1e6 / pupil_area
#Now let's plot the results of this, like we plotted the others
#Plotting
col_set = c("Violet","Blue","Green","Yellow","Orange","Red")
palette(col_set)
matplot(pupil_area,PPFD_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "PPFD (micromoles/m^2/s)",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Wavelength = 455 nm","Wavelength = 492 nm","Wavelength = 577 nm","Wavelength = 597 nm","Wavelength = 622 nm","Wavelength = 780 nm")
cex = .5
legend(pupil_area[1],PPFD_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
View(PPFD_eye)
View(PPFD_eye)
#Lets convert these numbers into PPFD to be able to compare them to what we know
PPFD_eye = (Photons_reach_eye /(6.02e23) * 1e6) / pupil_area
#Now let's plot the results of this, like we plotted the others
#Plotting
col_set = c("Violet","Blue","Green","Yellow","Orange","Red")
palette(col_set)
matplot(pupil_area,PPFD_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "PPFD (micromoles/m^2/s)",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Wavelength = 455 nm","Wavelength = 492 nm","Wavelength = 577 nm","Wavelength = 597 nm","Wavelength = 622 nm","Wavelength = 780 nm")
cex = .5
legend(pupil_area[1],PPFD_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
View(PPFD_eye)
View(PPFD_eye)
#Lets convert these numbers into PPFD to be able to compare them to what we know
PPF_eye = (Photons_reach_eye /(6.02e23) * 1e6)
#Now let's plot the results of this, like we plotted the others
#Plotting
col_set = c("Violet","Blue","Green","Yellow","Orange","Red")
palette(col_set)
matplot(pupil_area,PPF_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "PPF (micromoles/s)",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Wavelength = 455 nm","Wavelength = 492 nm","Wavelength = 577 nm","Wavelength = 597 nm","Wavelength = 622 nm","Wavelength = 780 nm")
cex = .5
legend(pupil_area[1],PPF_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = c("Violet","Blue","Green","Yellow","Orange","Red")
palette(col_set)
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Wavelength = 455 nm","Wavelength = 492 nm","Wavelength = 577 nm","Wavelength = 597 nm","Wavelength = 622 nm","Wavelength = 780 nm")
cex = .5
legend(pupil_area[1],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
# Planck's constant [Js]
h=6.62606896e-34
# speed of light [m/s]
c=2.99792458e8
# Boltzman constant [J/K]
k=1.3806504e-23
# temperature used for sun in example [K]
T = 5800
# the following lambda will not be used, this is for the entire spectrum of visible light
#lambda = seq(3.4e-7,8.05e-7, by=1e-10)
# this lambda sequence is for the band of wavelengths used in the example problem [currently in meters]
lambda = seq(6.0e-7,6.05e-7, by=1e-10)
# Equation 1
y = (h*c)/(lambda*k*T)
plot(lambda,y,xlab='Wavelength (m)',ylab='Plancks Exponential',main='Exponential from Plancks Equation')
I=((2*pi)*(h)*(c**2)/((lambda**5)*(exp(y)-1)))
plot(lambda,I,xlab='Wavelength (m)',ylab='Spectral Emittance (W/m^2/m)',main='Spectral Emittance over specified wavelenghts')
Ilambda = (I*(max(lambda)-min(lambda)))*1e-6
plot(I,Ilambda,xlab='Spectral Emittance (W/m^2/m)',ylab='Intensity (MW/m^2)',main='Intensity for range of spectral emittance')
abline(h=median(Ilambda))
plot(lambda,Ilambda,xlab='Wavelenght (m)',ylab='Intensity (MW/m^2)',main='Intensity for range of wavelengths')
abline(h=median(Ilambda))
lambda_nm=lambda*1e+9
I_new = I/1e+9
plot(lambda_nm,I_new,xlab='Wavelength (nm)',ylab='Spectral Emittance (W/m^2/nm)',main='Spectral emittance over range of wavelenths (in nm)')
# Open the librarys that are needed to do the following steps.
#knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(ggplot2)
# Read in the data
tab<-read_csv("https://raw.githubusercontent.com/Agron508/Homework/master/SS-110_1010_12918noon.csv")
# Some cleaning
data<-tab[2:482,] # select rows
data<-data %>% rename(waveL=Timestamp) # rename column
data$waveL<-as.numeric(as.vector(data$waveL)) # to get a x_continous scale, data need to be numeric not factor
#Plot the Spectral Irradiance as a function of wavelength (nm)
time<-data[,82]# here I just pick a column randomly
#class(time)
# time has to be converted into numeric
time<-as.numeric(unlist(time)) # I used unlist to convert all the element to a single numeric vector
ggplot(data=data,aes(x=waveL,y=time))+
geom_line() +
scale_x_continuous(breaks = round(seq(min(data$waveL), max(data$waveL), by = 100),1)) +
scale_y_continuous(breaks = round(seq(min(time), max(time), by = 0.005),1)) +
ggtitle("Spectral irradiance from class") +
xlab("wavelength (nm)") +
ylab(expression(paste("Spectral Irradiance (W/m2/",mu,"m)")))
irradiance = time/1e+3
wavelength = data$waveL
plot(wavelength,irradiance,type="o",xlab='Wavelength (nm)',ylab='Spectral Irradiance (W/m^2/nm)',main='Spectral irradiance of data collected in class')
sum(irradiance)*diff(wavelength)[1]
irradiance_data = irradiance[261:266]
band_data = data$waveL[261:266]
plot(band_data,irradiance_data,type="o",xlab='Wavelength (nm)',ylab='Spectral Irradiance (W/m^2/nm)',main='Spectral Irradiance from Collected Data')
plot(lambda_nm,I_new,type="o",xlab='Wavelength (nm)',ylab='Spectral Emittance (W/m^2/nm)',main='Spectral Emittance from Textbook')
# Blackbody Integration (emittance)
bb_E_integ = sum(I_new)*diff(lambda_nm)[1]
cat("Blackbody value of total power: ", bb_E_integ, "W/m^2")
# Observed Integration (irradiance)
obs_I_integ = sum(irradiance_data)*diff(band_data)[1]
cat("Observed value of total power: ", obs_I_integ, "W/m^2")
T2 = 6000
lambda2 = seq(3.4e-7,8.05e-7, by=1e-10)
y2 = (h*c)/(lambda2*k*T2)
I2=((2*pi)*(h)*(c**2)/((lambda2**5)*(exp(y2)-1)))
plot(lambda2,I2,xlab='Wavelength (m)',ylab='Spectral Emittance (W/m^2/m)',main='Spectral emmittance for visible range')
tot = sum(I2)*diff(lambda2)[1]
cat("Observed value of total power: ", tot, "W/m^2")
#Intensity of radiation reaching the eye in order for the human eye to percieve light.
I_eye = 4.0e-11 # Units - W/m^2
#The following are called in the beginning of the assingment:
#Plancks Constant: h = 6.63e-34 # Units - J*s
#Speed of light in a vacuum: c = 3.0e8 # Units - m/s
#Diameter of a human pupil
d = seq(2,8,by = 1) # Units - mm
#Convert the diameter to meters
d = d*1e-3 # Units - m
#Calculate the pupil area
pupil_area = pi*((d/2)^2) # Units - m^2
#Power reaching the eye
Power_reach_eye = I_eye*pupil_area # Units - W
#Range of wavelength in the visible spectrum
#lam_pupil = seq(380e-9,780e-9,by = 1e-9) #Units - m
lam_pupil = array(c(455e-9,492e-9,577e-9,597e-9,622e-9,780e-9))
#Energy of a photon
e = (h*c)/lam_pupil #Units - J
#Create Vector for Calculations
Photons_reach_eye = matrix(0,6,7)
#Number of photons reaching the eye
for(i in 1:6){
for(j in 1:7){
Photons_reach_eye[i,j] = Power_reach_eye[j]/e[i] #Units - photons/s
}
}
Photons_reach_eye = t(Photons_reach_eye)
#Set data up in a frame to plot
#data_pup = data.frame(x = lam_pupil,y1 = Photons_reach_eye[,1], y2 = Photons_reach_eye[,2], y3 = #Photons_reach_eye[,3], y4 = Photons_reach_eye[,4], y5 = Photons_reach_eye[,5], y6 = #Photons_reach_eye[,6], y7 = Photons_reach_eye[,7])
#Plotting
col_set = c("Violet","Blue","Green","Yellow","Orange","Red")
palette(col_set)
matplot(pupil_area,Photons_reach_eye,type = "l",main = "Photons That Reach The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "Number of Photons",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Wavelength = 455 nm","Wavelength = 492 nm","Wavelength = 577 nm","Wavelength = 597 nm","Wavelength = 622 nm","Wavelength = 780 nm")
cex = .5
legend(pupil_area[1],Photons_reach_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Lets convert these numbers into PPF to be able to compare them to what we know
PPF_eye = (Photons_reach_eye /(6.02e23) * 1e6)
#Now let's plot the results of this, like we plotted the others
#Plotting
col_set = c("Violet","Blue","Green","Yellow","Orange","Red")
palette(col_set)
matplot(pupil_area,PPF_eye,type = "l",main = "PPF That Reaches The Human Eye at Different Wavelengths with Different Pupil Sizes",cex.main = .8,xlab = "Pupil Area (m^2)",ylab = "PPF (micromoles/s)",lty = "solid", lwd = "2",col = col_set)
leg.txt <- c("Wavelength = 455 nm","Wavelength = 492 nm","Wavelength = 577 nm","Wavelength = 597 nm","Wavelength = 622 nm","Wavelength = 780 nm")
cex = .5
legend(pupil_area[1],PPF_eye[7,6],leg.txt,cex = .5,lwd = 2, col = col_set)
#Because we can calculate the number of photons by taking the Intensity of the Radiation in our pupil divided by the energy of a photon at that wavelength, we can take the intensity measured divided by the power at that wavelength and come up with a total number of photons!
#Lets assume a pupil size of 6mm
#Calculating the Intensity of radiation hitting your eye
Intensity_pupil = time * pupil_area[5] #Units - W
#Calculating the photon energy of the wavelengths that we measured
e_meas = (h*c)/(wavelength*1e-9) #Units - J
#Now to calculate the number of photons that are making it to our eyes
Photons_reach_eye_measured = Intensity_pupil/e_meas#Units - Photons/s
#If we sum up all of the photons from every wavelength, we see about how many photons per second are hitting our eyes
Total_Photons = sum(Photons_reach_eye_measured)#Units - Photons/s
cat("Total Photons Reaching Our Eyes With Our Measured Data:", Total_Photons," Photons/s")
install.packages("shiny")
install.packages("shinydashboard")
install.packages("plotly")
library(shiny); runApp('agron508shiny.R')
